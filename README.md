# Comercio SA
API RESTful para gerenciamento de Cliente e seus Contatos

### Objetivo
Demonstrar conhecimento em Java com o Framework Spring Boot, capacidade de interpretar requsitos e aplicaÃ§Ã£o de boas praticas de programaÃ§Ã£o e estrutura de codigo. 

## Tecnologias utilizadas
- Linguagem: Java
- Framework : Spring Boot
- Banco de dados relacional: PostgreSQL
- ORM : Hibernate

## ðŸ“¦ InstalaÃ§Ã£o
### PrÃ©-Requisitos
- JDK 17 ou superior
- Maven
- Docker ou Alguma ferramenta para manipular banco postgresql (pgAdmin por exemplo)

### Clone o repositorio e acesse o arquivo
```
git clone https://github.com/seu-usuario/ComercioSA.git
cd ComercioSA
```
### Crie o banco de dados
vocÃª pode criar esse banco com o docker ou crie um banco postgresql no pgAdmin por exemplo

### Criando no Docker
```
docker  run --name ComercioSA -e POSTGRES_USER=admin -e POSTGRES_PASSWORD=password123 -e POSTGRES_DB=comercio -d -p 5432:5432 postgres
```
### Criando com pgAdmin
1. Abra o pgAdmin
2. Adicione um novo servidor
   Clique com o botÃ£o direito em Servers > Create > Server...

3. Na aba General:
   Name: ComercioSA (pode ser qualquer nome)

4. Na aba Connection:
   Host name/address: localhost
    Port: 5432
    Username: admin
    Password: password123
    Marque a opÃ§Ã£o Save password se quiser.
5. Clique em Save

### ObservaÃ§Ãµes
Caso necessario altere as variaveis de conexÃ£o no arquivo application.properties

```
spring.application.name=ComercioSA
spring.datasource.url=jdbc:postgresql://localhost:5432/comercio
spring.datasource.username=admin
spring.datasource.password=password123
spring.jpa.hibernate.ddl-auto=update
```

### CriaÃ§Ã£o e populaÃ§Ã£o do banco de dados
O banco serÃ¡ gerado automaticamente com auxilio do hibernate e prÃ©-populado por script para facilitar os testes

### ObservaÃ§Ãµes 
Caso a tabela de contatos nÃ£o esteja populada apÃ³s a inicializaÃ§Ã£o, basta rodar o projeto novamente. 

### Requisitos Funcionais 
- [X] RF01: O sistema deve permitir o cadastro de clientes com os seguintes dados: Nome,
CPF, Data de Nascimento e EndereÃ§o;
- [X] RF02: O sistema deve permitir a ediÃ§Ã£o dos dados de um cliente cadastrado;
- [X] RF03: O sistema deve permitir a exclusÃ£o de um cliente cadastrado;
- [X] RF04: O sistema deve permitir a listagem de todos os clientes cadastrados;
- [X] RF05: O sistema deve permitir a busca de um cliente pelo Nome ou CPF;
- [X] RF06: O sistema deve permitir o cadastro de contatos para um cliente, contendo os seguintes dados: Tipo do Contato (Telefone, E-mail), Valor do Contato (nÃºmero ou e-mail) e ObservaÃ§Ã£o;
- [X] RF07: O sistema deve permitir a ediÃ§Ã£o dos contatos de um cliente;
- [X] RF08: O sistema deve permitir a exclusÃ£o de um contato de um cliente;
- [X] RF09: O sistema deve permitir a listagem de todos os contatos de um cliente.
especÃ­fico.
### Regras de Negocio
- [X] RN01: Os campos Nome e CPF sÃ£o obrigatÃ³rios no cadastro do cliente;
- [X] RN02: Os campos Tipo do Contato e Valor do Contato sÃ£o obrigatÃ³rios no cadastro do contato;
- [X] RN03: O CPF informado deve ser Ãºnico no sistema;
- [X] RN04: O Nome do cliente nÃ£o pode estar vazio;
- [X] RN05: A Data de Nascimento deve ser vÃ¡lida;
- [X] RN06: Um cliente pode ter mais de um contato cadastrado;
- [X] RN07: Ao excluir um cliente, todos os seus contatos devem ser removidos do sistema;
- [X] RN08: O sistema deve validar os dados informados antes de permitir o cadastro ou ediÃ§Ã£o.

## ðŸ“‚ Estrutura do codigo
```
Comercio-SA/
src/
â””â”€â”€ main/
    â”œâ”€â”€ java/
    â”‚   â””â”€â”€ br/com/muralis/comercio/
    â”‚       â”œâ”€â”€ config/         # ConfiguraÃ§Ãµes gerais da aplicaÃ§Ã£o
    â”‚       â”œâ”€â”€ controller/     # Controladores REST
    â”‚       â”œâ”€â”€ dto/            # Data Transfer Objects
    â”‚       â”‚   â”œâ”€â”€ clientDTO/  # DTOs especÃ­ficos para Cliente
    â”‚       â”‚   â””â”€â”€ error/      # DTOs para tratamento de erros
    â”‚       â”œâ”€â”€ entity/         # Entidades JPA (modelos do banco de dados)
    â”‚       â”œâ”€â”€ exception/      # ManipulaÃ§Ã£o global de exceÃ§Ãµes
    â”‚       â”œâ”€â”€ repository/     # Interfaces JPA para acesso ao banco
    â”‚       â”œâ”€â”€ script/         # Scripts de inicializaÃ§Ã£o de dados
    â”‚       â””â”€â”€ service/        # LÃ³gica de negÃ³cio da aplicaÃ§Ã£o
    â””â”€â”€ resources/
        â”œâ”€â”€ static/             # Arquivos estÃ¡ticos (CSS, JS, imagens)
        â”œâ”€â”€ templates/          # Templates (ex: Thymeleaf)
        â””â”€â”€ application.properties  # ConfiguraÃ§Ãµes da aplicaÃ§Ã£o

```

## SQL
O codigo sql Ã© gerado diretamente pelo Hibernate e populado atravÃ©s de um script em java mas caso tenha necessidade esse Ã© o sql para criaÃ§Ã£o das tabelas 

```postgresql
create table client
(
    id              bigint generated by default as identity
        primary key,
    cpf             varchar(14)  not null
        constraint ukplnstg0h55xcbwkkf8iehxo71
            unique,
    data_nascimento date         not null,
    endereco        varchar(255),
    nome            varchar(100) not null
);

alter table client
    owner to admin;

create table contact
(
    id         bigint generated by default as identity
        primary key,
    observacao varchar(255),
    tipo       varchar(50)  not null,
    valor      varchar(100) not null,
    client_id  bigint
        constraint fkt0lxtgfimywi23cewqbmgdu62
            references client
);

alter table contact
    owner to admin;
```

----------------

## RequisiÃ§Ãµes de Cliente
### Cadastro de cliente
```
url: localhost:8080/clients
```
Corpo da requisiÃ§Ã£o
```json
{
    "nome":"exemplo",
    "cpf": "123.123.123-44",
    "dataNascimento": "2001-12-15",
    "endereco": "exemplo"
}
```

### AtualizaÃ§Ã£o de cliente
```
- Url:  localhost:8080/clients/1
```
Corpo da requisiÃ§Ã£o
```json
{
    "nome":"exemplo",
    "cpf": "123.123.123-44",
    "dataNascimento": "2001-12-15",
    "endereco": "exemplo"
}
```

### ExclusÃ£o de cliente

Basta adicionar o id ao final da url
```
localhost:8080/clients/1
```
- Todos os contatos de um cliente sÃ£o excluidos juntamente com ele.

### Busca de todos os Clientes
a busca de todos os clientes pode ser realizada sem filtro, adicionando parte de um nome ou parte de um cpf 
```
localhost:8080/clients
localhost:8080/clients?filter=123456789
localhost:8080/clients?filter=exemplo
```
### Busca de um cliente por id
Basta adicionar o id ao final da url
```
localhost:8080/clients/1
```
----------------
## RequisiÃ§Ãµes de Contatos
### Buscar contato por id
```
localhost:8080/contacts/1
```
### Criar contato
Para criar um contato passe o id cliente pela url e corpo do objeto da requisiÃ§Ã£o
```
localhost:8080/contacts/1 #Esse numero "1" Ã© o id do cliente
```
```json
{
    "tipo":"telefone",
    "valor": "99999-9999",
    "observacao": "nÃ£o obrigatorio"
}
```
### Atualizar contato
Para atualizar, passe o id do contato e o corpo do objeto na requisiÃ§Ã£o
```
localhost:8080/contacts/1   #Esse numero "1" Ã© o id do contato
```
```json
{
    "tipo":"telefone",
    "valor": "99999-9999",
    "observacao": "nÃ£o obrigatorio"
}
```
### excluir contato
Passe o id do contato na url utilizando o metodo delete
```
localhost:8080/contacts/1 
```
------

